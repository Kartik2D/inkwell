<!--
  Entry Point - HTML Structure
  
  Defines three canvas elements stacked with z-index layering:
  - UI Canvas (z-index: 3): Receives ALL input events, displays cursor/overlays
  - Pixel Canvas (z-index: 2): Low-resolution pixel drawing (temporary, cleared after tracing)
  - Paper Canvas (z-index: 1): Final vector paths rendered with Paper.js
  
  All canvases are full viewport size, absolutely positioned and stacked.
  The pixel canvas uses CSS image-rendering: pixelated for crisp low-res display.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>DrawVector - Pixel to Vector Drawing</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #f5f5f5;
      touch-action: none;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
    }

    #canvas-container {
      position: relative;
      width: 100%;
      height: 100%;
      touch-action: none;
    }

    canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      touch-action: none;
    }

    #paper-canvas {
      z-index: 1;
      background: white;
    }

    #pixel-canvas {
      z-index: 2;
      image-rendering: pixelated;
      image-rendering: crisp-edges;
    }

    #ui-canvas {
      z-index: 3;
      pointer-events: auto;
      cursor: crosshair;
    }

    #control-panel {
      position: fixed;
      top: 20px;
      right: 20px;
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      z-index: 1000;
      min-width: 250px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    }

    .control-group {
      margin-bottom: 20px;
    }

    .control-group:last-child {
      margin-bottom: 0;
    }

    .control-group label {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: #333;
      margin-bottom: 8px;
    }

    .control-group label > span {
      display: block;
      margin-bottom: 8px;
    }

    .slider-container {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .slider-container input[type="range"] {
      flex: 1;
      height: 6px;
      border-radius: 3px;
      background: #e0e0e0;
      outline: none;
      -webkit-appearance: none;
    }

    .slider-container input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: #666;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .slider-container input[type="range"]::-moz-range-thumb {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: #666;
      cursor: pointer;
      border: none;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .slider-container span {
      min-width: 40px;
      text-align: right;
      font-size: 14px;
      color: #666;
      font-weight: 500;
    }

    .color-container {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .color-container input[type="color"] {
      -webkit-appearance: none;
      appearance: none;
      width: 40px;
      height: 40px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      padding: 0;
      background: none;
    }

    .color-container input[type="color"]::-webkit-color-swatch-wrapper {
      padding: 0;
    }

    .color-container input[type="color"]::-webkit-color-swatch {
      border: 2px solid #e0e0e0;
      border-radius: 6px;
    }

    .color-container input[type="color"]::-moz-color-swatch {
      border: 2px solid #e0e0e0;
      border-radius: 6px;
    }

    .color-container span {
      font-size: 13px;
      color: #666;
      font-weight: 500;
      font-family: monospace;
    }

    .toggle-label {
      display: flex !important;
      flex-direction: row !important;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0 !important;
    }

    .toggle-label > span {
      margin-bottom: 0 !important;
    }

    .toggle-label input[type="checkbox"] {
      -webkit-appearance: none;
      appearance: none;
      width: 44px;
      height: 24px;
      background: #e0e0e0;
      border-radius: 12px;
      position: relative;
      cursor: pointer;
      transition: background 0.2s;
    }

    .toggle-label input[type="checkbox"]::before {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 20px;
      height: 20px;
      background: white;
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      transition: transform 0.2s;
    }

    .toggle-label input[type="checkbox"]:checked {
      background: #666;
    }

    .toggle-label input[type="checkbox"]:checked::before {
      transform: translateX(20px);
    }

    .tool-buttons {
      display: flex;
      gap: 8px;
    }

    .tool-button {
      flex: 1;
      padding: 8px 12px;
      background: #f0f0f0;
      color: #333;
      border: 2px solid transparent;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .tool-button:hover {
      background: #e0e0e0;
    }

    .tool-button.active {
      background: #666;
      color: white;
      border-color: #444;
    }

    .tool-button.active:hover {
      background: #555;
    }

    #clear-button {
      width: 100%;
      padding: 10px 20px;
      background: #666;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }

    #clear-button:hover {
      background: #444;
    }

    #clear-button:active {
      background: #222;
    }

    /* Mobile toggle button for control panel */
    #panel-toggle {
      display: none;
      position: fixed;
      top: 16px;
      right: 16px;
      width: 44px;
      height: 44px;
      background: white;
      border: none;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      z-index: 1001;
      cursor: pointer;
      font-size: 20px;
      align-items: center;
      justify-content: center;
    }

    /* Mobile responsive styles */
    @media (max-width: 600px) {
      #panel-toggle {
        display: flex;
      }

      #control-panel {
        top: auto;
        bottom: 0;
        right: 0;
        left: 0;
        border-radius: 16px 16px 0 0;
        min-width: unset;
        padding: 16px 20px 24px;
        transform: translateY(100%);
        transition: transform 0.3s ease;
      }

      #control-panel.open {
        transform: translateY(0);
      }

      .control-group {
        margin-bottom: 16px;
      }

      /* Horizontal layout for mobile */
      #control-panel .control-group:last-child {
        margin-bottom: 0;
      }
    }

    @media (max-width: 600px) and (max-height: 500px) {
      /* Landscape mobile - more compact */
      #control-panel {
        padding: 12px 16px 16px;
      }

      .control-group {
        margin-bottom: 10px;
      }

      .control-group label > span {
        margin-bottom: 4px;
        font-size: 12px;
      }
    }
  </style>
</head>
<body>
  <div id="canvas-container">
    <canvas id="paper-canvas"></canvas>
    <canvas id="pixel-canvas"></canvas>
    <canvas id="ui-canvas"></canvas>
  </div>
  <button id="panel-toggle" aria-label="Toggle controls">⚙️</button>
  <script type="module" src="/src/app.ts"></script>
  <script>
    // Mobile panel toggle
    const toggle = document.getElementById('panel-toggle');
    toggle.addEventListener('click', () => {
      const panel = document.getElementById('control-panel');
      if (panel) {
        panel.classList.toggle('open');
        toggle.textContent = panel.classList.contains('open') ? '✕' : '⚙️';
      }
    });
  </script>
</body>
</html>
